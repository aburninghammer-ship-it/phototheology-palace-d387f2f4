<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>Phototheology Bible Learning Suite</title>
    <meta name="description" content="The complete Bible learning suite. Master Scripture through the 8-floor Palace method — store God's Word as images, patterns, and structures with Christ-centered interpretation." />
    <meta name="author" content="Phototheology" />
    
    <!-- EARLY TRACKING: Fire before React mounts to capture true bounces -->
    <script>
      (function() {
        try {
          var startTime = Date.now();
          var sessionId = sessionStorage.getItem('pt_session_id');
          if (!sessionId) {
            sessionId = 'ses_' + Math.random().toString(36).substr(2, 9) + '_' + startTime;
            sessionStorage.setItem('pt_session_id', sessionId);
          }
          
          // Record page hit immediately
          var hitData = {
            timestamp: startTime,
            session_id: sessionId,
            page: window.location.pathname,
            referrer: document.referrer || 'direct',
            user_agent: navigator.userAgent,
            screen: window.screen.width + 'x' + window.screen.height,
            viewport: window.innerWidth + 'x' + window.innerHeight,
            is_mobile: /Mobile|Android|iPhone/i.test(navigator.userAgent)
          };
          
          // Store for later sync with Supabase
          var hits = JSON.parse(sessionStorage.getItem('pt_early_hits') || '[]');
          hits.push(hitData);
          sessionStorage.setItem('pt_early_hits', JSON.stringify(hits));
          
          // Track time on page for bounce detection
          window.__ptStartTime = startTime;
          window.__ptSessionId = sessionId;
          
          // Send beacon on page unload to capture bounces
          window.addEventListener('pagehide', function() {
            var timeOnPage = Date.now() - window.__ptStartTime;
            var bounceData = {
              session_id: window.__ptSessionId,
              page: window.location.pathname,
              time_on_page_ms: timeOnPage,
              is_bounce: timeOnPage < 10000, // Less than 10 seconds = bounce
              timestamp: Date.now()
            };
            
            var bounces = JSON.parse(sessionStorage.getItem('pt_bounces') || '[]');
            bounces.push(bounceData);
            sessionStorage.setItem('pt_bounces', JSON.stringify(bounces));
            
            // Try to send via beacon
            if (navigator.sendBeacon) {
              navigator.sendBeacon('/api/track-bounce', JSON.stringify(bounceData));
            }
          });
          
          console.debug('[PT Early Tracking] Initialized', hitData);
        } catch (e) {
          console.debug('[PT Early Tracking] Error:', e);
        }
      })();
    </script>
    
    <!-- Preconnect to critical origins for faster resource loading -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://tdjtumtdkjicnhlpqqzd.supabase.co" />
    
    <!-- Preload critical font for faster rendering -->
    <link rel="preload" as="font" type="font/woff2" href="https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7W0Q5nw.woff2" crossorigin />
    
    <!-- Load fonts with display=swap to prevent render blocking -->
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Inter:wght@400;500;600&family=Cinzel:wght@400;600;700;900&family=Cormorant+Garamond:wght@300;400;600;700&family=Playfair+Display:wght@400;700;900&display=swap" rel="stylesheet" media="print" onload="this.media='all'" />
    <noscript><link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Inter:wght@400;500;600&family=Cinzel:wght@400;600;700;900&family=Cormorant+Garamond:wght@300;400;600;700&family=Playfair+Display:wght@400;700;900&display=swap" rel="stylesheet" /></noscript>

    <meta property="og:title" content="Phototheology Bible Learning Suite - Master Scripture Through the Palace Method" />
    <meta property="og:description" content="The complete Bible learning suite. Master Scripture through the 8-floor Palace method — store God's Word as images, patterns, and structures." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://thephototheologyapp.com" />
    <meta property="og:image" content="https://thephototheologyapp.com/phototheology-hero.png" />
    <meta property="og:image:alt" content="Phototheology Bible Learning Suite" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="Phototheology Bible Learning Suite" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Phototheology Bible Learning Suite - Master Scripture Through the Palace Method" />
    <meta name="twitter:description" content="The complete Bible learning suite. Master Scripture through the 8-floor Palace method — store God's Word as images, patterns, and structures." />
    <meta name="twitter:image" content="https://thephototheologyapp.com/phototheology-hero.png" />
    <meta name="twitter:image:alt" content="Phototheology Palace Method" />
    
    <!-- Critical CSS for above-the-fold content -->
    <style>
      /* Prevent layout shift while fonts load */
      body { font-family: Inter, system-ui, sans-serif; }
      
      /* Loading skeleton styles - inline for instant display */
      .pt-skeleton {
        background: linear-gradient(90deg, hsl(var(--muted)) 25%, hsl(var(--muted-foreground)/0.1) 50%, hsl(var(--muted)) 75%);
        background-size: 200% 100%;
        animation: pt-shimmer 1.5s infinite;
      }
      @keyframes pt-shimmer {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
      }
      
      /* Initial loading state */
      #root:empty {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      #root:empty::after {
        content: '';
        width: 40px;
        height: 40px;
        border: 3px solid hsl(var(--primary)/0.2);
        border-top-color: hsl(var(--primary));
        border-radius: 50%;
        animation: pt-spin 0.8s linear infinite;
      }
      @keyframes pt-spin {
        to { transform: rotate(360deg); }
      }
    </style>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
